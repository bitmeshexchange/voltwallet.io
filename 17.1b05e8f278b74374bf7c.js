(window.webpackJsonp=window.webpackJsonp||[]).push([[17,4],{1071:function(e,t,n){"use strict";n.r(t);var r,a=n(1),o=n.n(a),i=n(165),c=n(1034),u=n.n(c),s=n(19),l=n(1133),p=(n(1208),n(1228)),f=(n(560),n(281)),y=(n(559),n(138)),d=(n(1103),n(1105)),m=(n(561),n(166)),b=(n(1098),n(1099)),v=n(74),h=n(5),g=n(67),w=n.n(g),O=n(1112),j=(n(282),n(1085));function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I,N,R,W=Object(j.c)(),C=Object(i.connect)((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){P(e,t,n[t])}))}return e}({},e.wallet)}))(r=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),E(this,_(t).apply(this,arguments))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=W.currencyCode.toLowerCase();if("usd"===e)return"".concat(W.symbol).concat(value);var t=w()(exchangeRate[e]).multipliedBy(value).toFixed(2,1).toString();return"".concat(W.symbol).concat(t)}}])&&k(n.prototype,r),a&&k(n,a),t}(a.Component))||r,A=n(1043),T=n.n(A),L=n(1165),D=n(17);function B(e){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(e,t,n,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function F(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){M(o,r,a,i,c,"next",e)}function c(e){M(o,r,a,i,c,"throw",e)}i(void 0)}))}}function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function q(e){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function K(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G(e,t){return(G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var V,Y,z,$=[Object(s.a)("owned"),Object(s.a)("buy_new")],U=b.a.Item,Z=(I=b.a.create(),N=Object(i.connect)((function(e){var t=e.user,n=e.wallet,r=e.loading.effects;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){J(e,t,n[t])}))}return e}({},t,n,{loading:r["service/queryPaymailById"],addLoading:r["service/addPaymail"],signLoading:r["service/signSingWalletMessage"],broadcasting:r["service/broadcast"]})})),Object(v.withRouter)(R=I(R=N(R=function(e){function t(e){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,a=q(t).call(this,e),n=!a||"object"!==B(a)&&"function"!=typeof a?K(r):a,J(K(n),"gotoBack",(function(){n.props.history.goBack()})),J(K(n),"switchMenu",(function(e){n.setState({currentMenuIndex:e})})),J(K(n),"queryPaymail",function(){var e=F(regeneratorRuntime.mark((function e(t,r,a){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(/^[a-zA-Z0-9]{1,20}$/.test(r)){e.next=3;break}return e.abrupt("return",a(Object(s.a)("invalidPaymail")));case 3:return e.next=5,n.props.dispatch({type:"service/queryPaymail",payload:{name:r}});case 5:if(!((o=e.sent)>0)){e.next=8;break}return e.abrupt("return",a(Object(s.a)("existing")));case 8:if(0!==o){e.next=10;break}return e.abrupt("return",a());case 10:return e.abrupt("return",a("error"));case 11:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),J(K(n),"assignPrimary",function(){var e=F(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.props.dispatch({type:"service/setMainPaymail",payload:{wid:n.getWalletId(),id:t}});case 2:return m.a.success(Object(s.a)("setting_success")),e.next=5,n.props.dispatch({type:"service/updateWallet",payload:{type:parseInt(type)}});case 5:n.update();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),J(K(n),"handleSubmit",(function(e){e.preventDefault();var t=n.props,r=t.form,a=t.wallets[1][0];r.validateFields(function(){var e=F(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=6;break}return e.next=3,n.props.dispatch({type:"service/queryPaymailById",payload:{wid:a.id}});case 3:return e.sent,n.showDrawer(),e.abrupt("return");case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())})),J(K(n),"showDrawer",(function(){n.setState({drawer_visible:!0})})),J(K(n),"closeDrawer",(function(){n.setState({drawer_visible:!1})})),n.state={currentMenuIndex:0,drawer_visible:!1},n}var n,r,a,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G(e,t)}(t,e),n=t,(r=[{key:"getWalletId",value:function(){return this.props.match.params.id}},{key:"update",value:(c=F(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.dispatch({type:"service/queryPaymailById",payload:{wid:this.getWalletId()}});case 2:this.setState({currentMenuIndex:0});case 3:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"payCallback",value:function(e){e&&this.addPaymail(),this.closeDrawer()}},{key:"addPaymail",value:(i=F(regeneratorRuntime.mark((function e(){var t,n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.form,r=t.dispatch,a=n.getFieldsValue(),e.next=4,r({type:"service/addPaymail",payload:{wid:this.getWalletId(),name:a.name}});case 4:m.a.success(Object(s.a)("add_success")),this.update();case 6:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"render",value:function(){var e,t,n=this,r=this.props,a=r.currentWallet,i=(r.loading,r.form),c=r.addLoading,u=void 0!==c&&c,l=(r.wallets,r.signLoading),m=void 0!==l&&l,v=r.broadcasting,h=void 0!==v&&v,g=a.paymail,w=a.token,S=this.state.currentMenuIndex,k=i.getFieldDecorator,E=i.getFieldValue;g&&g.length>0&&(e=g.find((function(e){return 1===e.main})),t=g.filter((function(e){return 0===e.main})),e||(e=g[0],t=g.slice(1)));var _="";u?_="adding...":m?_="Signing...":h&&(_="Broadcasting");var x=E("name");return o.a.createElement("div",{className:T.a.container},o.a.createElement(O.a,{token:w}),o.a.createElement("div",{className:T.a.title},Object(s.a)("wallet_paymail")),o.a.createElement("span",{className:T.a.goback,onClick:this.gotoBack}," ",Object(s.a)("cancel")),o.a.createElement("div",{className:T.a.op_container},o.a.createElement("div",{className:T.a.op},$.map((function(e,t){return o.a.createElement("div",{className:S===t?Object(j.d)(T.a.item,T.a.current_item):T.a.item,key:e,onClick:function(){return n.switchMenu(t)}},e)})))),0===S&&o.a.createElement(o.a.Fragment,null,g&&g.length>0?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:T.a.label},Object(s.a)("primary_paymail")),o.a.createElement("div",{className:T.a.value},e?o.a.createElement("div",null,o.a.createElement("span",{className:T.a.name},e.name),"@","volt.id"):Object(s.a)("no_main_paymail"))):o.a.createElement("div",{className:T.a.tips},Object(s.a)("no_paymail")),t&&t.length>0&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:T.a.label},Object(s.a)("other_paymail")),o.a.createElement("div",{className:T.a.paymails},o.a.createElement("div",null,t.map((function(e,t){return o.a.createElement("div",{className:T.a.value,key:e.id},o.a.createElement("div",null,o.a.createElement("span",{className:T.a.name},e.name),"@","volt.id"),1===e.main?o.a.createElement("div",{className:T.a.primary},Object(s.a)("primary_paymail")):o.a.createElement("div",{className:T.a.action,onClick:function(){return n.assignPrimary(e.id)}},Object(s.a)("assign_primary")))})))))),1===S&&o.a.createElement(f.a,{spinning:u||m||h,tip:_},o.a.createElement(b.a,{onSubmit:this.handleSubmit},o.a.createElement(U,{className:T.a.input},k("name",{initialValue:x,rules:[{required:!0},{validator:this.queryPaymail}]})(o.a.createElement(d.a,{addonAfter:"@".concat("volt.id")}))),o.a.createElement(y.a,{type:"primary",htmlType:"submit",className:T.a.btn},Object(s.a)("buy_for")," ",o.a.createElement(C,{value:Object(D.c)(x)})))),this.state.drawer_visible&&o.a.createElement(p.a,{width:480,title:Object(s.a)("confirm_payment"),placement:"right",closable:!1,maskClosable:!1,onClose:this.closeDrawer,visible:this.state.drawer_visible,getContainer:!1,style:{position:"absolute"}},o.a.createElement(L.a,{note:"Buy a new Paymail ".concat(x),payCallback:function(e){return n.payCallback(e)},unitPrice:Object(D.c)(x)})))}}])&&H(n.prototype,r),a&&H(n,a),t}(a.Component))||R)||R)||R);function Q(e){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function te(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ne(e,t){return(ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}h.Transaction.Sighash;var ae,oe=h.crypto.Signature,ie=(h.crypto.ECDSA,h.crypto.BN,h.Transaction.Signature,oe.SIGHASH_ALL,oe.SIGHASH_FORKID,Object(s.a)("owned"),Object(s.a)("buy_new"),b.a.Item,V=b.a.create(),Y=Object(i.connect)((function(e){var t=e.user,n=e.wallet,r=e.loading.effects;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){re(e,t,n[t])}))}return e}({},t,n,{loading:r["service/queryPaymailById"],addLoading:r["service/addPaymail"],signLoading:r["service/signSingWalletMessage"],broadcasting:r["service/broadcast"]})})),Object(v.withRouter)(z=V(z=Y(z=function(e){function t(e){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,a=ee(t).call(this,e),n=!a||"object"!==Q(a)&&"function"!=typeof a?te(r):a,re(te(n),"gotoBack",(function(){n.props.history.goBack()})),n.state={currentMenuIndex:0,drawer_visible:!1},n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ne(e,t)}(t,e),n=t,(r=[{key:"getWalletId",value:function(){return this.props.match.params.id}},{key:"render",value:function(){var e,t,n=this.props,r=n.currentWallet,a=(n.loading,n.form),i=(n.addLoading,n.wallets,n.signLoading,n.broadcasting,r.paymail),c=r.token,u=this.state.currentMenuIndex;return a.getFieldDecorator,i&&i.length>0&&(e=i.find((function(e){return 1===e.main})),t=i.filter((function(e){return 0===e.main})),e||(e=i[0],t=i.slice(1))),o.a.createElement("div",{className:T.a.container},o.a.createElement(O.a,{token:c}),o.a.createElement("div",{className:T.a.title},Object(s.a)("wallet_paymail")),o.a.createElement("span",{className:T.a.goback,onClick:this.gotoBack}," ",Object(s.a)("cancel")),o.a.createElement("div",{className:T.a.tips},Object(s.a)("view_paymail_desc")),0===u&&o.a.createElement(o.a.Fragment,null,i&&i.length>0?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:T.a.label},Object(s.a)("primary_paymail")),o.a.createElement("div",{className:T.a.value},e?o.a.createElement("div",null,o.a.createElement("span",{className:T.a.name},e.name),"@","volt.id"):Object(s.a)("no_main_paymail"))):o.a.createElement("div",{className:T.a.tips},Object(s.a)("no_paymail")),t&&t.length>0&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:T.a.label},Object(s.a)("other_paymail")),o.a.createElement("div",{className:T.a.paymails},o.a.createElement("div",null,t.map((function(e,t){return o.a.createElement("div",{className:T.a.value,key:e.id},o.a.createElement("div",null,o.a.createElement("span",{className:T.a.name},e.name),"@","volt.id"),1===e.main&&o.a.createElement("div",{className:T.a.primary},Object(s.a)("primary_paymail")))})))))))}}])&&X(n.prototype,r),a&&X(n,a),t}(a.Component))||z)||z)||z),ce=n(283);function ue(e){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function se(e,t,n,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pe(e,t){return!t||"object"!==ue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fe(e){return(fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ye(e,t){return(ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function de(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"default",(function(){return me}));var me=Object(i.connect)((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){de(e,t,n[t])}))}return e}({},e.wallet,{loading:e.loading.effects["service/queryWallet"]})}))(ae=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=pe(this,fe(t).call(this,e))).state={loading:!1,change_address:""},n}var n,r,a,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ye(e,t)}(t,e),n=t,(r=[{key:"getWalletId",value:function(){return this.props.match.params.id}},{key:"ready",value:(i=regeneratorRuntime.mark((function e(){var t,n,r,a,o,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),(t=this.props.match.params).type,n=t.id,e.next=4,this.getWalletDetail(parseInt(n));case 4:if(r=this.props,a=r.dispatch,r.match,!((o=this.props.wallets[1]).length<1)){e.next=10;break}return e.next=9,a({type:"service/queryWallet",payload:{type:1}});case 9:o=e.sent;case 10:return i=o[0],e.next=13,a({type:"service/createSingleWalletAddress",payload:{wid:i.id,type:2}});case 13:c=e.sent,this.setState({change_address:c,loading:!1});case 15:case"end":return e.stop()}}),e,this)})),c=function(){var e=this,t=arguments;return new Promise((function(n,r){var a=i.apply(e,t);function o(e){se(a,n,r,o,c,"next",e)}function c(e){se(a,n,r,o,c,"throw",e)}o(void 0)}))},function(){return c.apply(this,arguments)})},{key:"render",value:function(){var e=this.props,t=e.loading,n=e.currentWallet,r=e.userid;if(t||!n||!n.id||this.state.loading)return o.a.createElement(ce.a,null);var a=n.founderId,i=n.type;return o.a.createElement("div",{className:u.a.container},this.renderSidebar(),o.a.createElement("div",{className:u.a.detail},2===parseInt(i)&&a!==r?o.a.createElement(ie,null):o.a.createElement(Z,{change_address:this.state.change_address})))}}])&&le(n.prototype,r),a&&le(n,a),t}(l.a))||ae},1085:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return d}));n(1106);var r=n(3),a=n.n(r),o=n(67),i=n.n(o),c=n(282);window.location;function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";return e?("string"==typeof e&&/^\d+$/.test(e)&&(e=parseInt(e,10)),a()(e).format(t)):e}var s=/^(\w-*\.*)+@(\w-?)+(\.\w{2,})+$/;function l(e){return!!e&&s.test(e)}function p(){return Array.prototype.slice.call(arguments).join(" ")}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[2,7];if(e)return e.length<t[0]+t[1]?e:e.substr(0,t[0])+"****"+e.substr(-t[1],t[1])}var y=function(e){return i()(e).div(1e8).toString()},d=function(){var e=c.a.findIndex((function(e){return"usd"===e.currencyCode.toLowerCase()})),t=window.localStorage.getItem("VoltLocalCurrencyIndex")||e,n=c.a[t];return n||(window.localStorage.removeItem("VoltLocalCurrencyIndex"),n=c.a[e]),n}},1112:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(1),a=n.n(r),o=n(139),i=n(1037),c=n.n(i),u=n(17);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),p(this,f(t).apply(this,arguments))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this.props.className||c.a.icon,t=this.props.token||1;return a.a.createElement("div",{className:e},a.a.createElement(o.a,{type:Object(u.i)(t).icon}))}}])&&l(n.prototype,r),i&&l(n,i),t}(r.Component)},1133:function(e,t,n){"use strict";var r,a,o=n(1),i=n.n(o),c=n(165),u=n(1034),s=n.n(u),l=(n(283),n(19)),p=(n(568),n(290)),f=n(1039),y=n.n(f),d=(n(560),n(281)),m=n(1040),b=n.n(m),v=n(74),h=n(1085),g=n(17);function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t,n,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var x,P,I=(r=Object(c.connect)((function(e){var t=e.wallet;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){_(e,t,n[t])}))}return e}({},e.user,t,{loading:e.loading.effects["service/queryWallet"]})})),Object(v.withRouter)(a=r(a=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=S(this,k(t).call(this,e))).bgcs=[],n.state={joining:0,hideAmount:window.localStorage.getItem(g.a.HIDEAMOUNT)||0},n}var n,r,a,o,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(t,e),n=t,(r=[{key:"getWalletId",value:function(){var e=this.props,t=e.match,n=e.wallets,r=t.params.id,a=n[t.params.type];if(void 0===r)for(var o=0;o<a.length;o++){var i=a[o];i.join,i.status,r=i.id;break}return r}},{key:"joinWallet",value:(o=regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),this.setState({joining:t}),e.next=4,this.props.dispatch({type:"service/joinWallet",payload:{wid:t}});case 4:n=e.sent,this.setState({joining:0}),n&&n.success&&this.props.dispatch({type:"service/updateWallet"});case 7:case"end":return e.stop()}}),e,this)})),c=function(){var e=this,t=arguments;return new Promise((function(n,r){var a=o.apply(e,t);function i(e){O(a,n,r,i,c,"next",e)}function c(e){O(a,n,r,i,c,"throw",e)}i(void 0)}))},function(e){return c.apply(this,arguments)})},{key:"componentWillReceiveProps",value:function(e){e.hideAmount!==this.state.hideAmount&&this.setState({hideAmount:e.hideAmount})}},{key:"render",value:function(){var e=this.props,t=e.loading,n=e.match,r=e.wallets,a=parseInt(n.params.type)||1,o=r[a];if(0===o.length)return i.a.createElement("div",{className:b.a.nodata},Object(l.a)("nodata"));var c=this.state.hideAmount,u=this.getWalletId();return i.a.createElement(d.a,{spinning:t},i.a.createElement("div",{className:b.a.list,id:"J_walletList"},i.a.createElement("div",{className:b.a.list_content},o.map((function(e){var t=e.name,n=e.id,r=e.type,o=e.joinStatus,s=e.founder,l=e.status,p=e.balance,f=e.share,y=e.waitJoin,d=e.token,m=e.threshold,w=parseInt(n)===parseInt(u)?Object(h.d)(b.a.item_contrainer,b.a.current_item):b.a.item_contrainer,O=(c?g.l:Object(h.b)(p),null);Object(g.b)(d),0===o?O=i.a.createElement("span",{className:b.a.join},"JOIN WALLET"):0===parseInt(l)&&(O=i.a.createElement("span",{className:b.a.wait_join},y," MEMBERS TO JOIN"));var j=i.a.createElement("div",{className:b.a.list_item},i.a.createElement("div",{className:b.a.wallet_name},i.a.createElement("span",{className:b.a.name,title:t},t," "),2===r&&i.a.createElement("span",{className:b.a.wallet_no},m," | ",f)),2===r&&i.a.createElement("div",{className:b.a.wallet_info},O),0===parseInt(l)&&i.a.createElement("div",{className:b.a.wallet_desc},s));return i.a.createElement(v.Link,{to:"/message/list/".concat(a,"/").concat(n),key:n,className:w,id:parseInt(n)===parseInt(u)?"J_currentWallet":null},j)})))))}}])&&j(n.prototype,r),a&&j(n,a),t}(o.Component))||a)||a),N=n(139);function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}x=Object(c.connect)((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){L(e,t,n[t])}))}return e}({},e.wallet)})),Object(v.withRouter)(P=x(P=function(e){function t(){var e,n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,c=new Array(o),u=0;u<o;u++)c[u]=arguments[u];return r=this,a=(e=C(t)).call.apply(e,[this].concat(c)),n=!a||"object"!==R(a)&&"function"!=typeof a?A(r):a,L(A(n),"renderWalletMenu",(function(){var e=parseInt(n.props.match.params.type);return e||(e=1),i.a.createElement("div",{className:y.a.wallet_type},g.o.map((function(t,r){return 2===r&&n.props.newMsg?i.a.createElement("div",{key:t.key,className:r===e?y.a.selected:""},i.a.createElement(v.Link,{to:"/message/list/".concat(r)},i.a.createElement(p.a,{dot:!0},t.text))):r>0?i.a.createElement("div",{key:t.key,className:r===e?y.a.selected:""},i.a.createElement(v.Link,{to:"/message/list/".concat(r)},t.text)):void 0})))})),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=parseInt(this.props.match.params.type);return e||(e=1),i.a.createElement("div",{className:y.a.list_container},this.renderWalletMenu(),i.a.createElement(I,{history:this.props.history}),i.a.createElement("div",{className:y.a.create_wallet},i.a.createElement(N.a,{type:"iconcreatewallet"}),i.a.createElement(v.Link,{to:"/message/createWallet/".concat(e)},Object(l.a)("create_wallet"))))}}])&&W(n.prototype,r),a&&W(n,a),t}(o.Component))||P);function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(e,t,n,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function M(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){B(o,r,a,i,c,"next",e)}function c(e){B(o,r,a,i,c,"throw",e)}i(void 0)}))}}function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function H(e,t){return!t||"object"!==D(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function q(e){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function K(e,t){return(K=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return G}));var G=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=H(this,q(t).call(this,e))).state={ready:!1},n}var n,r,a,o,c,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&K(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:(u=M(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props.match.params,n=t.type,r=t.id,this.saveCurrentWallet(n,r);case 2:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"getWalletId",value:function(e,t){if(void 0===t)for(var n=0;n<e.length;n++){t=e[n].id;break}return t}},{key:"saveCurrentWallet",value:(c=M(regeneratorRuntime.mark((function e(t,n,r){var a,o,i,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.props.dispatch,t=parseInt(t)||1,(o=this.props.wallets[t])&&!(o.length<1)){e.next=8;break}return e.next=6,a({type:"service/queryWallet",payload:{type:t}});case 6:(o=e.sent).length>0&&o.forEach(function(){var e=M(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==parseInt(t.type)||t.deposit&&t.deposit.address){e.next=3;break}return e.next=3,a({type:"service/createSingleWalletAddress",payload:{wid:t.id}});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:return i=-1,o&&o.length>0&&(i=this.getWalletId(o,n)),c=this.props.allWallets[i],e.next=13,this.props.dispatch({type:"wallet/save",payload:{currentId:i,currentWallet:c}});case 13:if(!c||1!==parseInt(c.type)||c.deposit&&c.deposit.address){e.next=16;break}return e.next=16,a({type:"service/createSingleWalletAddress",payload:{wid:i}});case 16:this.setState({ready:!0}),(u=document.getElementById("J_currentWallet"))&&u.scrollIntoView(),this.ready&&this.ready(parseInt(i));case 20:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"getWalletDetail",value:(o=M(regeneratorRuntime.mark((function e(t){var n,r,a,o,i,c,u,s,l,p,f,y,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.props,r=n.dispatch,a=n.allWallets,o=n.currentWallet,i=a[t],o&&o.id==t&&(i=o),i){e.next=5;break}return e.abrupt("return");case 5:if(i.parties&&!(i.parties.length<1)){e.next=10;break}return e.next=8,r({type:"wallet/queryParties",payload:{id:t}});case 8:c=e.sent,i.parties=c;case 10:if(i.paymail&&!(i.paymail.length<1)){e.next=15;break}return e.next=13,r({type:"service/queryPaymailById",payload:{wid:t}});case 13:u=e.sent,i.paymail=u;case 15:if(!(i.parties&&i.parties.length>0)){e.next=35;break}for(s=!0,l=!1,p=void 0,e.prev=19,f=i.parties[Symbol.iterator]();!(s=(y=f.next()).done);s=!0)(d=y.value).uid===i.uid&&(i.founder=d.user,i.founderId=d.uid);e.next=27;break;case 23:e.prev=23,e.t0=e.catch(19),l=!0,p=e.t0;case 27:e.prev=27,e.prev=28,s||null==f.return||f.return();case 30:if(e.prev=30,!l){e.next=33;break}throw p;case 33:return e.finish(30);case 34:return e.finish(27);case 35:r({type:"wallet/saveCurrent",payload:i});case 36:case"end":return e.stop()}}),e,this,[[19,23,27,35],[28,,30,34]])}))),function(e){return o.apply(this,arguments)})},{key:"loadTransactions",value:function(e){e&&-1!==e?this.props.dispatch({type:"service/queryTransaction",payload:{wid:e}}):this.props.dispatch({type:"wallet/saveTransaction",payload:{transactions:[]}})}},{key:"componentWillReceiveProps",value:function(e){var t=e.match.params.type,n=e.match.params.id,r=this.props.match.params.type,a=this.props.match.params.id;t===r&&void 0===n&&void 0===a||t===r&&n===a||this.props.currentId!==n&&this.saveCurrentWallet(t,n,t===r)}},{key:"renderSidebar",value:function(){}},{key:"render",value:function(){return i.a.createElement("div",{className:s.a.container},this.renderSidebar(),i.a.createElement("div",{className:s.a.detail}))}}])&&F(n.prototype,r),a&&F(n,a),t}(o.Component)},1165:function(e,t,n){"use strict";n(560);var r=n(281),a=(n(559),n(138)),o=(n(561),n(166)),i=(n(1135),n(1132)),c=n(1),u=n.n(c),s=n(165),l=n(67),p=n.n(l),f=n(283),y=n(1046),d=n.n(y),m=n(19),b=n(1085),v=n(17),h=n(5);function g(e,t,n,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function w(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){g(o,r,a,i,c,"next",e)}function c(e){g(o,r,a,i,c,"throw",e)}i(void 0)}))}}var O=h.Transaction.Sighash,j=h.crypto.Signature,S=h.crypto.ECDSA,k=h.crypto.BN,E=h.Transaction.Signature,x=j.SIGHASH_ALL|j.SIGHASH_FORKID,P=v.k[1];function I(e){return N.apply(this,arguments)}function N(){return(N=w(regeneratorRuntime.mark((function e(t){var n,r,a,i,c,u,s,l,f,y,d,m,b,v,g,I,N,R,W,C,A,T,L;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.personalWallet,r=t.price,t.payCallback,a=t.note,i=t.usdAmount,c=t.feerate,u=n.change,s=p()(i).div(r.bsv.usd).toFixed(8,1).toString(),l=n.utxo,f=p()(s).multipliedBy(1e8),y=f.toString(),(d=new h.Transaction).feePerKb(c.bsv2||5e3),m=!0,b=!1,v=void 0,e.prev=11,g=l[Symbol.iterator]();!(m=(I=g.next()).done);m=!0)N=I.value,f.isGreaterThan(0)&&(R=N.address,W=N.txid,C=N.value,A=N.vout,1===N.status&&(d.from({txId:W,outputIndex:A,script:h.Script.buildPublicKeyHashOut(R).toString(),satoshis:C}),f=f.minus(C)));e.next=19;break;case 15:e.prev=15,e.t0=e.catch(11),b=!0,v=e.t0;case 19:e.prev=19,e.prev=20,m||null==g.return||g.return();case 22:if(e.prev=22,!b){e.next=25;break}throw v;case 25:return e.finish(22);case 26:return e.finish(19);case 27:if(!f.isGreaterThan(0)){e.next=29;break}return e.abrupt("return",o.a.error(_("lack_of_balance")));case 29:return T=p()(s).multipliedBy(1e8).toNumber(),d.to(P,T),d.change(u),L=d.inputs.map((function(e,t){var n=e.output,r=n.script.toAddress().toString(),a=k.fromBuffer(O.sighash(d,x,t,n.script,n.satoshisBN),{endian:"little"});return{address:r,hash:("0".repeat(8)+a.toString("hex")).slice(-64)}})),e.next=35,t.dispatch({type:"service/signSingWalletMessage",payload:L});case 35:return e.sent.forEach((function(e,t){var n=new j({r:new k(e.r,16),s:S.toLowS(new k(e.s,16))}),r=d.inputs[t];d.applySignature(new E({publicKey:e.publicKey,prevTxId:r.prevTxId,outputIndex:r.outputIndex,inputIndex:t,sigtype:x,signature:n}))})),e.abrupt("return",new Promise(function(){var e=w(regeneratorRuntime.mark((function e(r,o){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.dispatch({type:"service/broadcast",payload:{tx:d,note:a,value:y,wid:n.id,biz_data:P,token:"bsv"}});case 2:i=e.sent,r(i);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 38:case"end":return e.stop()}}),e,null,[[11,15,19,27],[20,,22,26]])})))).apply(this,arguments)}var R=n(1155);function W(e,t,n,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function C(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){W(o,r,a,i,c,"next",e)}function c(e){W(o,r,a,i,c,"throw",e)}i(void 0)}))}}var A,T=R.Transaction.Sighash,L=R.crypto.Signature,D=R.crypto.ECDSA,B=R.crypto.BN,M=R.Transaction.Signature,F=L.SIGHASH_ALL|L.SIGHASH_FORKID,H=v.k[2];function q(e){return K.apply(this,arguments)}function K(){return(K=C(regeneratorRuntime.mark((function e(t){var n,r,a,o,i,c,u,s,l,f,y,d,m,b,v,h,g,w,O,j,S,k,E;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.personalWallet,r=t.price,a=t.note,o=t.usdAmount,i=t.feerate,c=n.change,u=p()(o).div(r.btc.usd).toFixed(8,1).toString(),s=n.utxo,l=p()(u).multipliedBy(1e8),f=l.toString(),0,(y=new R.Transaction).feePerKb(i.btc||71680),d=!0,m=!1,b=void 0,e.prev=12,v=s[Symbol.iterator]();!(d=(h=v.next()).done);d=!0)g=h.value,l.isGreaterThan(0)&&(w=g.address,O=g.txid,j=g.value,S=g.vout,1===g.status&&(y.from({txId:O,outputIndex:S,script:R.Script.buildPublicKeyHashOut(w).toString(),satoshis:j}),l=l.minus(j)));e.next=20;break;case 16:e.prev=16,e.t0=e.catch(12),m=!0,b=e.t0;case 20:e.prev=20,e.prev=21,d||null==v.return||v.return();case 23:if(e.prev=23,!m){e.next=26;break}throw b;case 26:return e.finish(23);case 27:return e.finish(20);case 28:if(!l.isGreaterThan(0)){e.next=30;break}return e.abrupt("return",new Promise((function(e,t){e({error:_("lack_of_balance")})})));case 30:return k=p()(u).multipliedBy(1e8).toNumber(),y.to(H,k),y.change(c),E=y.inputs.map((function(e,t){var n=e.output,r=n.script.toAddress().toString(),a=B.fromBuffer(T.sighash(y,F,t,n.script,n.satoshisBN),{endian:"little"});return{address:r,hash:("0".repeat(8)+a.toString("hex")).slice(-64)}})),e.next=36,t.dispatch({type:"service/signSingWalletMessage",payload:E});case 36:return e.sent.forEach((function(e,t){var n=new L({r:new B(e.r,16),s:D.toLowS(new B(e.s,16))}),r=y.inputs[t];y.applySignature(new M({publicKey:e.publicKey,prevTxId:r.prevTxId,outputIndex:r.outputIndex,inputIndex:t,sigtype:F,signature:n}))})),e.abrupt("return",new Promise(function(){var e=C(regeneratorRuntime.mark((function e(r,o){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.dispatch({type:"service/broadcast",payload:{tx:y,note:a,value:f,wid:n.id,biz_data:H,token:"btc"}});case 2:i=e.sent,r(i);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 39:case"end":return e.stop()}}),e,null,[[12,16,20,28],[21,,23,27]])})))).apply(this,arguments)}function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t,n,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function V(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){J(o,r,a,i,c,"next",e)}function c(e){J(o,r,a,i,c,"throw",e)}i(void 0)}))}}function Y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U(e,t){return(U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return X}));var Q=i.a.Option,X=Object(s.connect)((function(e){var t=e.user,n=e.wallet,r=e.loading.effects;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Z(e,t,n[t])}))}return e}({},t,n,{signLoading:r["service/signSingWalletMessage"],broadcasting:r["service/broadcast"]})}))(A=function(e){function t(){var e,n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return r=this,n=!(a=(e=z(t)).call.apply(e,[this].concat(i)))||"object"!==G(a)&&"function"!=typeof a?$(r):a,Z($(n),"state",{currentAccountIndex:-1,amount:0,ready:!1,posting:!1}),n}var n,c,s,l,y,h;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U(e,t)}(t,e),n=t,(c=[{key:"componentDidMount",value:(h=V(regeneratorRuntime.mark((function e(){var t,n,r,a,o,i,c,u,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,n=t.wallets,r=t.dispatch,a=t.price,o=t.unitPrice,!(n[1].length<1)){e.next=4;break}return e.next=4,r({type:"service/queryWallet",payload:{type:1}});case 4:i=-1,c=p()(o||1).div(a.bsv.usd).toFixed(8,1).toString(),u=0;case 7:if(!(u<n[1].length)){e.next=16;break}if(s=n[1][u],!(parseInt(s.balance)>1e8*parseFloat(c)+1e3)){e.next=13;break}return i=u,this.setState({currentAccountIndex:u}),e.abrupt("break",16);case 13:u++,e.next=7;break;case 16:if(!(i>-1)||n[1][i].change){e.next=19;break}return e.next=19,r({type:"service/createSingleWalletAddress",payload:{wid:n[1][i].id,type:2}});case 19:this.setState({currentAccountIndex:i,ready:!0});case 20:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"changeAccount",value:(y=V(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setState({currentAccountIndex:t,ready:!1}),n=this.props,r=n.wallets,a=n.dispatch,r[1][t].change){e.next=5;break}return e.next=5,a({type:"service/createSingleWalletAddress",payload:{wid:r[1][t].id,type:2}});case 5:this.setState({ready:!0});case 6:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"renderAccounts",value:function(){var e=this;if(this.state.ready){var t=this.props,n=t.wallets,r=t.price,a=t.unitPrice,o=this.state.currentAccountIndex;return u.a.createElement(i.a,{onChange:function(t){return e.changeAccount(t)},defaultValue:-1===o?void 0:o,placeholder:Object(m.a)("lack_balance"),style:{width:350},loading:!this.state.ready},n[1].map((function(e,t){var n=v.n[e.token].name,o=p()(a||1).div(r[n.toLowerCase()].usd).toFixed(8,1).toString();return u.a.createElement(Q,{value:t,key:e.id,disabled:parseInt(e.balance)<1e8*parseFloat(o)+1e3},e.name,"(",Object(b.b)(e.balance)," ",n,")")})))}}},{key:"createTransaction",value:(l=V(regeneratorRuntime.mark((function e(){var t,n,r,a,i,c,u,s,l,p,f=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.posting&&this.state.ready){e.next=2;break}return e.abrupt("return");case 2:if(t=this.props,n=t.wallets,r=t.price,a=t.payCallback,i=t.note,c=t.unitPrice,u=t.dispatch,s=t.feerate,l=this.state.currentAccountIndex,p=n[1][l]){e.next=7;break}return e.abrupt("return");case 7:if(this.setState({posting:!0}),2!==p.token){e.next=14;break}return e.next=11,q({personalWallet:p,usdAmount:c||1,price:r,note:i,dispatch:u,feerate:s}).then((function(e){console.log(e),f.setState({posting:!1}),e.success&&e.data.id?a(!0):o.a.error("Transaction failed. ".concat(e.error))})).catch((function(e){console.log(e)}));case 11:e.sent,e.next=18;break;case 14:if(1!==p.token){e.next=18;break}return e.next=17,I({personalWallet:p,usdAmount:c||1,price:r,note:i,dispatch:u,feerate:s}).then((function(e){console.log(e),f.setState({posting:!1}),e.success&&e.data.id?a(!0):o.a.error("Transaction failed. ".concat(e.error))})).catch((function(e){console.log(e)}));case 17:e.sent;case 18:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.props,n=t.note,o=t.price,i=t.payCallback,c=t.unitPrice,s=t.wallets,l=this.state,y=l.currentAccountIndex,b=l.ready;if(!o||!o.bsv||!b)return u.a.createElement(f.a,null);y<0&&(y=0);var h=s[1][y],g=v.n[h.token],w=p()(c||1).div(o[g.name.toLowerCase()].usd).toFixed(8,1).toString();return u.a.createElement(r.a,{spinning:this.state.posting},u.a.createElement("div",{className:d.a.pay_container},u.a.createElement("div",{className:d.a.title},Object(m.a)("pay_account_title")),u.a.createElement("div",{className:d.a.amount},w," ",g.name," ≈ ",c||1," USD"),u.a.createElement("div",{className:d.a.item},u.a.createElement("div",{className:d.a.label},Object(m.a)("to")),u.a.createElement("div",{className:d.a.value},v.k[h.token])),u.a.createElement("div",{className:d.a.item},u.a.createElement("div",{className:d.a.label},Object(m.a)("amount")),u.a.createElement("div",{className:d.a.value},w," ",g.name)),u.a.createElement("div",{className:d.a.item},u.a.createElement("div",{className:d.a.label},Object(m.a)("note")),u.a.createElement("div",{className:d.a.value},n)),u.a.createElement("div",{className:d.a.item},u.a.createElement("div",{className:d.a.label},Object(m.a)("account")),u.a.createElement("div",{className:d.a.value},this.renderAccounts())),u.a.createElement("div",{className:d.a.desc},Object(m.a)("pay_account_desc")),u.a.createElement("div",{className:d.a.btns},u.a.createElement(a.a,{type:"primary",className:d.a.btn,onClick:function(){return e.createTransaction()},loading:!b,disabled:y<0},Object(m.a)("ok")),u.a.createElement("span",{className:d.a.cancel,onClick:function(){return i(!1)}},Object(m.a)("cancel")))))}}])&&Y(n.prototype,c),s&&Y(n,s),t}(c.Component))||A}}]);